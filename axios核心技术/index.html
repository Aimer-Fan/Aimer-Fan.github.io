<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.48">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>axios从入门到源码 | AimerFan</title><meta name="description" content="aimer fan's blog repo.">
    <link rel="modulepreload" href="/assets/app.cbf35e07.js"><link rel="modulepreload" href="/assets/index.html.737f5985.js"><link rel="modulepreload" href="/assets/index.html.4e6e5c05.js"><link rel="prefetch" href="/assets/index.html.1e88ebbb.js"><link rel="prefetch" href="/assets/index.html.cedfaa0c.js"><link rel="prefetch" href="/assets/Git_GitHub.html.1ee39485.js"><link rel="prefetch" href="/assets/index.html.9cdccac4.js"><link rel="prefetch" href="/assets/index.html.f6641bb3.js"><link rel="prefetch" href="/assets/index.html.8690e658.js"><link rel="prefetch" href="/assets/brew-change-origin.html.836badd5.js"><link rel="prefetch" href="/assets/package-manager.html.1b1c9b42.js"><link rel="prefetch" href="/assets/package.json.html.4631f4f2.js"><link rel="prefetch" href="/assets/permission.html.153538bb.js"><link rel="prefetch" href="/assets/shadow-socks-r.html.d3305835.js"><link rel="prefetch" href="/assets/v2ray.html.fad86528.js"><link rel="prefetch" href="/assets/shell.html.a9cd359c.js"><link rel="prefetch" href="/assets/01-abstract.html.f0b6a374.js"><link rel="prefetch" href="/assets/02-grammar.html.661b7ff9.js"><link rel="prefetch" href="/assets/03-select.html.aeda8c6e.js"><link rel="prefetch" href="/assets/04-operator.html.475e4f3f.js"><link rel="prefetch" href="/assets/05-order-and-page.html.a3dab98a.js"><link rel="prefetch" href="/assets/06-multiple-table.html.c304e491.js"><link rel="prefetch" href="/assets/index.html.101b2f28.js"><link rel="prefetch" href="/assets/tapable.html.faa36181.js"><link rel="prefetch" href="/assets/vim.html.99ce84fd.js"><link rel="prefetch" href="/assets/cache.html.615fd64f.js"><link rel="prefetch" href="/assets/cross-origin-resource-sharing.html.f46eac43.js"><link rel="prefetch" href="/assets/cross-origin.html.b18fe09e.js"><link rel="prefetch" href="/assets/download-file.html.d2e313ab.js"><link rel="prefetch" href="/assets/gcc.html.222e57c3.js"><link rel="prefetch" href="/assets/gzip.html.91dd2ff1.js"><link rel="prefetch" href="/assets/qiankun.html.a5d58a01.js"><link rel="prefetch" href="/assets/regexp.html.215d01f7.js"><link rel="prefetch" href="/assets/vue3-reactivity.html.bcb7e472.js"><link rel="prefetch" href="/assets/index.html.e7560b41.js"><link rel="prefetch" href="/assets/404.html.265028f6.js"><link rel="prefetch" href="/assets/index.html.dae261ee.js"><link rel="prefetch" href="/assets/index.html.221a0ddc.js"><link rel="prefetch" href="/assets/Git_GitHub.html.b71f641d.js"><link rel="prefetch" href="/assets/index.html.a219482e.js"><link rel="prefetch" href="/assets/index.html.399c02c1.js"><link rel="prefetch" href="/assets/index.html.a8bb5dbf.js"><link rel="prefetch" href="/assets/brew-change-origin.html.85494073.js"><link rel="prefetch" href="/assets/package-manager.html.430b6d12.js"><link rel="prefetch" href="/assets/package.json.html.70aa6e0f.js"><link rel="prefetch" href="/assets/permission.html.c3bfacf6.js"><link rel="prefetch" href="/assets/shadow-socks-r.html.4d231b0f.js"><link rel="prefetch" href="/assets/v2ray.html.ce34de8f.js"><link rel="prefetch" href="/assets/shell.html.8bcf8348.js"><link rel="prefetch" href="/assets/01-abstract.html.9f66f3d0.js"><link rel="prefetch" href="/assets/02-grammar.html.9fe43eef.js"><link rel="prefetch" href="/assets/03-select.html.1deb7dbb.js"><link rel="prefetch" href="/assets/04-operator.html.fb89566a.js"><link rel="prefetch" href="/assets/05-order-and-page.html.ffce7199.js"><link rel="prefetch" href="/assets/06-multiple-table.html.a0377bf3.js"><link rel="prefetch" href="/assets/index.html.0a219270.js"><link rel="prefetch" href="/assets/tapable.html.c39dfe04.js"><link rel="prefetch" href="/assets/vim.html.e448d7cd.js"><link rel="prefetch" href="/assets/cache.html.83b1f755.js"><link rel="prefetch" href="/assets/cross-origin-resource-sharing.html.f5fa5b30.js"><link rel="prefetch" href="/assets/cross-origin.html.4032a9a4.js"><link rel="prefetch" href="/assets/download-file.html.186265ce.js"><link rel="prefetch" href="/assets/gcc.html.ee8d081b.js"><link rel="prefetch" href="/assets/gzip.html.9eb183a9.js"><link rel="prefetch" href="/assets/qiankun.html.ab499129.js"><link rel="prefetch" href="/assets/regexp.html.80ece7c3.js"><link rel="prefetch" href="/assets/vue3-reactivity.html.d546a9b9.js"><link rel="prefetch" href="/assets/index.html.5b0e47b3.js"><link rel="prefetch" href="/assets/404.html.ea6eaeaa.js"><link rel="prefetch" href="/assets/404.4d66fe86.js"><link rel="prefetch" href="/assets/Layout.a4a5a9b1.js">
    <link rel="stylesheet" href="/assets/style.acf36ec1.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container no-sidebar"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/images/background.png" alt="AimerFan"><span class="site-name can-hide">AimerFan</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/web/gcc" class="" aria-label="Web前端"><!--[--><!--]--> Web前端 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/sql/01-abstract" class="" aria-label="SQL"><!--[--><!--]--> SQL <!--[--><!--]--></a></div><div class="navbar-item"><a href="/tools/vim" class="" aria-label="工具库"><!--[--><!--]--> 工具库 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/drafts/permission" class="" aria-label="草稿箱"><!--[--><!--]--> 草稿箱 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/todo" class="" aria-label="TODO"><!--[--><!--]--> TODO <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/web/gcc" class="" aria-label="Web前端"><!--[--><!--]--> Web前端 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/sql/01-abstract" class="" aria-label="SQL"><!--[--><!--]--> SQL <!--[--><!--]--></a></div><div class="navbar-item"><a href="/tools/vim" class="" aria-label="工具库"><!--[--><!--]--> 工具库 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/drafts/permission" class="" aria-label="草稿箱"><!--[--><!--]--> 草稿箱 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/todo" class="" aria-label="TODO"><!--[--><!--]--> TODO <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><!----><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="axios从入门到源码" tabindex="-1"><a class="header-anchor" href="#axios从入门到源码" aria-hidden="true">#</a> axios从入门到源码</h1><h2 id="_1-http相关" tabindex="-1"><a class="header-anchor" href="#_1-http相关" aria-hidden="true">#</a> 1. HTTP相关</h2><h3 id="_1-1-http请求交互的基本过程" tabindex="-1"><a class="header-anchor" href="#_1-1-http请求交互的基本过程" aria-hidden="true">#</a> 1.1 HTTP请求交互的基本过程</h3><p><img src="/assets/http交互的基本过程.0a5fa837.png" alt="1576595580798"></p><ol><li>前后应用从浏览器端向服务器发送HTTP请求（请求报文）</li><li>后台服务器接收到请求后，调度服务器应用处理请求，向浏览器端返回HTTP响应（响应报文）</li><li>浏览器端接收到响应，解析显示响应体/调用监视回调</li></ol><h3 id="_1-2-http请求报文" tabindex="-1"><a class="header-anchor" href="#_1-2-http请求报文" aria-hidden="true">#</a> 1.2 HTTP请求报文</h3><ol><li>请求行</li><li>多个请求头</li><li>请求体</li></ol><h3 id="_1-3-http响应报文" tabindex="-1"><a class="header-anchor" href="#_1-3-http响应报文" aria-hidden="true">#</a> 1.3 HTTP响应报文</h3><ol><li>响应状态行</li><li>多个响应头</li><li>响应体</li></ol><h3 id="_1-4-post请求体参数格式" tabindex="-1"><a class="header-anchor" href="#_1-4-post请求体参数格式" aria-hidden="true">#</a> 1.4 post请求体参数格式</h3><ol><li><p>ContentType: application/x-www-form-urlencoded;charset=utf-8</p><p>用于键值对参数，参数的键值对用=链接，参数之间用&amp;链接</p></li><li><p>Content-Type: application/json;charset=utf-8</p><p>用于json字符串参数</p><p>例如：{&quot;name&quot;: &quot;123456&quot;, &quot;age&quot;: 18}</p></li><li><p>Content-Type: multipart/form-data</p><p>用于文件上传</p></li></ol><h3 id="_1-5-常见的响应状态码" tabindex="-1"><a class="header-anchor" href="#_1-5-常见的响应状态码" aria-hidden="true">#</a> 1.5 常见的响应状态码</h3><table><thead><tr><th>状态码</th><th>含义</th><th>描述</th></tr></thead><tbody><tr><td>200</td><td>OK</td><td>请求成功。一般用于GET和POST请求</td></tr><tr><td>201</td><td>Created</td><td>已创建。成功请求创建了新的资源</td></tr><tr><td>401</td><td>Unauthorized</td><td>未授权/请求要求用户的身份认证</td></tr><tr><td>404</td><td>Not Found</td><td>服务器无法根据客户端的请求找到资源</td></tr><tr><td>500</td><td>Internal Server Error</td><td>服务器内部错误，无法完成请求</td></tr></tbody></table><h3 id="_1-6-不同类型的请求及其作用" tabindex="-1"><a class="header-anchor" href="#_1-6-不同类型的请求及其作用" aria-hidden="true">#</a> 1.6 不同类型的请求及其作用</h3><table><thead><tr><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>GET</td><td>从服务器端读取数据</td></tr><tr><td>POST</td><td>向服务器端添加数据</td></tr><tr><td>PUT</td><td>更新服务器端的数据</td></tr><tr><td>DELETE</td><td>删除服务器端的数据</td></tr></tbody></table><h3 id="_1-7-api的分类" tabindex="-1"><a class="header-anchor" href="#_1-7-api的分类" aria-hidden="true">#</a> 1.7 API的分类</h3><ol><li>REST API：restful <ol><li>发送请求进行CRUD哪个操作由请求方式来决定</li><li>同一个请求路径可以进行多个操作</li><li>请求方式会用到GET/POST/PUT/DETLETE</li></ol></li><li>非REST API：restless <ol><li>请求方式不决定请求的CRUD</li><li>一个请求路径值对应一个操作</li><li>一般只有GET/POST</li></ol></li></ol><h3 id="_1-8-使用-json-server-搭建rest-api" tabindex="-1"><a class="header-anchor" href="#_1-8-使用-json-server-搭建rest-api" aria-hidden="true">#</a> 1.8 使用 json-server 搭建REST API</h3><p>https://github.com/typicode/json-server</p><h2 id="_2-xhr的理解和使用" tabindex="-1"><a class="header-anchor" href="#_2-xhr的理解和使用" aria-hidden="true">#</a> 2. XHR的理解和使用</h2><p>https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest</p><ol><li><p>区别一般http请求与ajax请求</p><ol><li>ajax请求是一种特别的http请求</li><li>对服务器端来说，没有任何区别，区别在于浏览器端</li><li>浏览器端发送请求：只有XHR或fetch发出的才是ajax请求，其它所有的都是非ajax请求</li><li>浏览器端接收到响应 <ol><li>一般请求：浏览器一般会直接显示响应体数据，也就是我们常说的刷新/跳转页面</li><li>ajax请求：浏览器不会对界面进行任何更新操作，只是调用监视的回调函数并传入响应相关数据</li></ol></li></ol></li><li><p>API</p><ol><li><p>XMLHttpRequest()：创建XHR对象的构造函数</p></li><li><p>status：响应状态码值，比如200，404</p></li><li><p>statusText：响应状态文本</p></li><li><p>readyState：标记请求状态的制度属性</p><p>0：初始</p><p>1：open()之后</p><p>2：send()之后</p><p>3：请求中</p></li><li><p>onreadystatechange：绑定readyState改变的监听</p></li><li><p>responseType：指定响应数据类型，如果是 json，得到响应后自动解析响应体数据</p></li><li><p>response：响应体数据，类型取决于responseType的指定</p></li><li><p>timeout：指定请求超时时间，默认为0代表没有限制</p></li><li><p>ontimeout：绑定超时的监听\</p></li><li><p>onerror：绑定请求网络错误的监听</p></li><li><p>open()：初始化一个请求，参数为:(method. url[, async])</p></li><li><p>send(data)：发送请求</p></li><li><p>abort()：终端请求</p></li><li><p>getResponseHeader(name)：获取指定名称的响应头值</p></li><li><p>getAllResponseHeaders()：获取所有响应头组成的字符串</p></li><li><p>setRequestHeader(name, value)：设置请求头</p></li></ol></li></ol><h2 id="_3-axios的理解和使用" tabindex="-1"><a class="header-anchor" href="#_3-axios的理解和使用" aria-hidden="true">#</a> 3. axios的理解和使用</h2><ol><li><p>axios是什么？</p><ol><li>前端最流行的ajax请求库</li><li>react/vue官方都推荐使用axios</li></ol></li><li><p>axios特点</p><ol><li>基于promise的异步编程ajax请求库</li><li>浏览器端/node端都可以使用</li><li>支持请求/响应拦截器</li><li>支持/响应数据转换</li><li>批量发送多个请求</li></ol></li><li><p>axios常用语法</p><ol><li>axios(config)：通用/最本质的发任意类型请求的发送</li><li>axios(url[, config])：可以只指定url发get请求</li><li>axios.request(config)：等同于axios(config)</li><li>axios.get(url[, config])：发get请求</li><li>axios.delete(url[, config])：发delete请求</li><li>axios.post(url[, data, config])：发post请求</li><li>axios.put(url[, data, config])：发put请求</li><li>axios.defaults.xxx：请求的默认全局配置</li><li>axios.interceptor.request.use()：添加请求拦截器</li><li>axios.interceptor.response.use()：添加相应拦截器</li><li>axois.create([config])：创建一个新的axios（它没有下面的功能）</li><li>axios.Cancel()：用于创建取消请求的错误对象</li><li>axios.CancelToken()：用于创建取消请求的token对象</li><li>axios.isCancel()：是否是一个取消请求的错误</li><li>axios.all(promises)：用于批量执行多个异步请求</li></ol></li></ol><h3 id="_4-axois-源码分析" tabindex="-1"><a class="header-anchor" href="#_4-axois-源码分析" aria-hidden="true">#</a> 4. axois 源码分析</h3><ol><li><p>axios和Axios的关系？</p><ol><li>从语法上来说：axios不是Axios的实例</li><li>从功能上来说：axios时Axios的实例</li><li>axios时Axios.prototype.request函数的bind返回的函数</li><li>axios作为对象有Axios原型对象上的所有方法，有Axios对象上所有的属性</li></ol></li><li><p>instance与axios的区别？</p><ol><li>相同： <ol><li>都是一个能发任意请求的函数：request(config)</li><li>都有发特定请求的各种方法：get()/post()/pull()/delete()</li><li>都有默认配置和拦截器的属性：default/interceptor</li></ol></li><li>不同： <ol><li>默认匹配的值很可能不一样</li><li>instance没有axios后面添加的一些方法：create()/CancelToken()/all()</li></ol></li></ol></li><li><p>流程图</p><p><img src="/assets/流程图.0b8d8d80.png" alt="流程图"></p></li><li><p>整体流程</p><ol><li><p>request(config) ==&gt; dispatchRequest(config) ==&gt; xhrAdapter(config)</p></li><li><p>request(config)：</p><p>将请求拦截器/dispatchRequest()/响应拦截器 通过promise链串联起来，返回promise</p></li><li><p>dispatchRequest(config)</p><p>转换请求数据 ==&gt; 调用xhrAdapter()发送请求 ==&gt; 请求返回后转换响应数据，返回promis4</p></li><li><p>xhrAdapter(config)：</p><p>创建XHR对象，根据config进行相关设置，发送特定请求，并接收响应数据，返回promise</p></li></ol></li><li><p>axios的请求/响应拦截器工作流程</p><p><img src="/assets/axios的请求和响应拦截器工作流程.656e17b8.png" alt="axios的请求/响应拦截器工作流程"></p><p>axios利用promise链的特点，准备一个 chain数组 预先存入 dispathRequest, undefined，在请求拦截器中每次取出一个 fulfilled和rejected 函数 放到 chain 首部，在响应拦截器中每次取出一个 fulfilled和rejected 函数放到chain 尾部，所以导致请求拦截器后申明的先被调用。</p><p>chain: [dispatchRequest, undefined] interceptors.request：[{fulfilled1, rejected1}, {fulfilled2, rejected2}] interceptors.response：[{fulfilledA, rejectedA}, {fulfilledB, rejectedB}] ===========&gt; chain：[ fulfilled2, rejected2, fulfilled1, rejected1, dispatchRequest, undefined, fulfilledA, rejectedA, fulfilledB, rejectedB ]</p></li><li><p>如何取消未完成的请求？</p><ol><li>当配置了cancelToken 对象时，保存cancel函数 <ol><li>创建一个用于将来中断请求的cancelPromise</li><li>并定义了一个用于中断请求的cancel函数</li><li>将cancel函数传递出来</li></ol></li><li>调用cancel()取消请求 <ol><li>执行cancel函数，传入错误信息message</li><li>内部会让cancelPromise变为成功，且成功的值为一个Cancel对象</li><li>在cancelPromise的成功回调中中断请求，并让发请求的promise失败，失败的reason为Cancel对象</li></ol></li></ol></li></ol></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 1261105760@qq.com">AimerFan</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.cbf35e07.js" defer></script>
  </body>
</html>
